---

// Data fetching
import { getSiteSettings } from '@/data/siteSettings'
import { getHero } from '@/data/hero'
import { getIntro } from '@/data/intro'
import { getTeamMembers } from '@/data/team'
import { getWorkItems } from '@/data/work'
import { getProducts } from '@/data/products'

// Components
import BaseLayout from '../layouts/BaseLayout.astro';
import Loader from '../components/Loader.astro';
import Header from '../components/Header.astro';
import Nav from '../components/Nav.astro';
import Copyright from '../components/Copyright.astro';
import Footer from '../components/Footer.astro';
import Modal from '../components/Modal.astro';
import Hero from '../components/sections/Hero.astro';
import Intro from '../components/sections/Intro.astro';
import About from '../components/sections/About.astro';
import Work from '../components/sections/Work.astro'; 
import Products from '../components/sections/Products.astro';
import Canvas from '../components/Canvas.astro';
import '../styles/global.scss';

const settings = await getSiteSettings()
const hero = await getHero()
const intro = await getIntro()
const team = await getTeamMembers()
const works = await getWorkItems()
const products = await getProducts()

// Build page title and description
const baseTitle = settings.siteTagline
  ? `${settings.siteTitle} | ${settings.siteTagline}`
  : settings.siteTitle;

const pageTitle =
  settings?.seo?.metaTitle ?? baseTitle;

const pageDescription =
  settings?.seo?.metaDescription ??
  'Hot Lava Agency delivers innovative, non-toxic advertising solutions. We specialize in creative strategy, digital marketing, and brand development for forward-thinking companies.';
---

<BaseLayout
  title={pageTitle},
  description={pageDescription},
  canonical="/"
  includeVimeo={true}
  preloadImages={[
    '/images/phrase.jpg',
    '/images/flow.jpg',
    '/team/kristi.jpg',
    '/team/phil.jpg',
    '/team/nik.jpg',
    '/team/ben.jpg',
  ]}
>   
  <Loader />
  <canvas id="fluid"></canvas>
  <Modal />

  <Header />
  <Nav siteSettings={settings}/>
  <Copyright />

  <main id="main-content">
    <h1 class="sr-only">{settings.siteTitle}</h1>
    <Hero hero={hero} />
    <Intro config={intro} />
    <About team={team} /> 
    <Work works={works} />
    <Products />
  </main>

  <Footer siteSettings={settings}/> 
  <Canvas />

  <script>
    import '../scripts/main.js';
    import '../scripts/smoke.js';
  </script>

</BaseLayout>

